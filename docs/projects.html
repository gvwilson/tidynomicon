<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 11 Projects | The Tidynomicon</title>
  <meta name="description" content="Chapter 11 Projects | The Tidynomicon">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 11 Projects | The Tidynomicon" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 11 Projects | The Tidynomicon" />
  <meta name="github-repo" content="gvwilson/tidynomicon" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Projects | The Tidynomicon" />
  
  <meta name="twitter:description" content="Chapter 11 Projects | The Tidynomicon" />
  

<meta name="author" content="Greg Wilson">


<meta name="date" content="2019-04-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intellectual-debt.html">
<link rel="next" href="testing.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Tidynomicon</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#s:index-personas"><i class="fa fa-check"></i><b>1.1</b> Who are these lessons for?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="values-and-vectors.html"><a href="values-and-vectors.html"><i class="fa fa-check"></i><b>2</b> Values and Vectors</a><ul>
<li class="chapter" data-level="2.1" data-path="values-and-vectors.html"><a href="values-and-vectors.html#questions"><i class="fa fa-check"></i><b>2.1</b> Questions</a></li>
<li class="chapter" data-level="2.2" data-path="values-and-vectors.html"><a href="values-and-vectors.html#how-do-i-say-hello"><i class="fa fa-check"></i><b>2.2</b> How do I say hello?</a></li>
<li class="chapter" data-level="2.3" data-path="values-and-vectors.html"><a href="values-and-vectors.html#how-do-i-add-numbers"><i class="fa fa-check"></i><b>2.3</b> How do I add numbers?</a></li>
<li class="chapter" data-level="2.4" data-path="values-and-vectors.html"><a href="values-and-vectors.html#how-do-i-store-many-numbers-together"><i class="fa fa-check"></i><b>2.4</b> How do I store many numbers together?</a></li>
<li class="chapter" data-level="2.5" data-path="values-and-vectors.html"><a href="values-and-vectors.html#how-do-i-index-a-vector"><i class="fa fa-check"></i><b>2.5</b> How do I index a vector?</a></li>
<li class="chapter" data-level="2.6" data-path="values-and-vectors.html"><a href="values-and-vectors.html#how-do-i-create-new-vectors-from-old"><i class="fa fa-check"></i><b>2.6</b> How do I create new vectors from old?</a></li>
<li class="chapter" data-level="2.7" data-path="values-and-vectors.html"><a href="values-and-vectors.html#how-else-does-r-represent-the-absence-of-data"><i class="fa fa-check"></i><b>2.7</b> How else does R represent the absence of data?</a></li>
<li class="chapter" data-level="2.8" data-path="values-and-vectors.html"><a href="values-and-vectors.html#key-points"><i class="fa fa-check"></i><b>2.8</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="indexing.html"><a href="indexing.html"><i class="fa fa-check"></i><b>3</b> Indexing</a><ul>
<li class="chapter" data-level="3.1" data-path="indexing.html"><a href="indexing.html#questions-1"><i class="fa fa-check"></i><b>3.1</b> Questions</a></li>
<li class="chapter" data-level="3.2" data-path="indexing.html"><a href="indexing.html#how-can-i-store-a-mix-of-different-types-of-objects"><i class="fa fa-check"></i><b>3.2</b> How can I store a mix of different types of objects?</a></li>
<li class="chapter" data-level="3.3" data-path="indexing.html"><a href="indexing.html#what-is-the-difference-between-and"><i class="fa fa-check"></i><b>3.3</b> What is the difference between <code>[</code> and <code>[[</code>?</a></li>
<li class="chapter" data-level="3.4" data-path="indexing.html"><a href="indexing.html#how-can-i-access-elements-by-name"><i class="fa fa-check"></i><b>3.4</b> How can I access elements by name?</a></li>
<li class="chapter" data-level="3.5" data-path="indexing.html"><a href="indexing.html#how-can-i-create-and-index-a-matrix"><i class="fa fa-check"></i><b>3.5</b> How can I create and index a matrix?</a></li>
<li class="chapter" data-level="3.6" data-path="indexing.html"><a href="indexing.html#key-points-1"><i class="fa fa-check"></i><b>3.6</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>4</b> Control Flow</a><ul>
<li class="chapter" data-level="4.1" data-path="control-flow.html"><a href="control-flow.html#questions-2"><i class="fa fa-check"></i><b>4.1</b> Questions</a></li>
<li class="chapter" data-level="4.2" data-path="control-flow.html"><a href="control-flow.html#how-do-i-choose-and-repeat-things"><i class="fa fa-check"></i><b>4.2</b> How do I choose and repeat things?</a></li>
<li class="chapter" data-level="4.3" data-path="control-flow.html"><a href="control-flow.html#how-can-i-express-a-range-of-values-in-r"><i class="fa fa-check"></i><b>4.3</b> How can I express a range of values in R?</a></li>
<li class="chapter" data-level="4.4" data-path="control-flow.html"><a href="control-flow.html#how-can-i-use-a-vector-in-a-conditional-statement"><i class="fa fa-check"></i><b>4.4</b> How can I use a vector in a conditional statement?</a></li>
<li class="chapter" data-level="4.5" data-path="control-flow.html"><a href="control-flow.html#how-do-i-create-and-call-functions"><i class="fa fa-check"></i><b>4.5</b> How do I create and call functions?</a></li>
<li class="chapter" data-level="4.6" data-path="control-flow.html"><a href="control-flow.html#how-can-i-write-a-function-that-takes-a-varying-number-of-arguments"><i class="fa fa-check"></i><b>4.6</b> How can I write a function that takes a varying number of arguments?</a></li>
<li class="chapter" data-level="4.7" data-path="control-flow.html"><a href="control-flow.html#how-can-i-provide-default-values-for-arguments"><i class="fa fa-check"></i><b>4.7</b> How can I provide default values for arguments?</a></li>
<li class="chapter" data-level="4.8" data-path="control-flow.html"><a href="control-flow.html#how-can-i-hide-the-value-that-r-returns"><i class="fa fa-check"></i><b>4.8</b> How can I hide the value that R returns?</a></li>
<li class="chapter" data-level="4.9" data-path="control-flow.html"><a href="control-flow.html#how-can-i-assign-to-a-global-variable-from-inside-a-function"><i class="fa fa-check"></i><b>4.9</b> How can I assign to a global variable from inside a function?</a></li>
<li class="chapter" data-level="4.10" data-path="control-flow.html"><a href="control-flow.html#key-points-2"><i class="fa fa-check"></i><b>4.10</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-tidyverse.html"><a href="the-tidyverse.html"><i class="fa fa-check"></i><b>5</b> The Tidyverse</a><ul>
<li class="chapter" data-level="5.1" data-path="the-tidyverse.html"><a href="the-tidyverse.html#questions-3"><i class="fa fa-check"></i><b>5.1</b> Questions</a></li>
<li class="chapter" data-level="5.2" data-path="the-tidyverse.html"><a href="the-tidyverse.html#how-do-i-read-data"><i class="fa fa-check"></i><b>5.2</b> How do I read data?</a></li>
<li class="chapter" data-level="5.3" data-path="the-tidyverse.html"><a href="the-tidyverse.html#how-do-i-inspect-data"><i class="fa fa-check"></i><b>5.3</b> How do I inspect data?</a></li>
<li class="chapter" data-level="5.4" data-path="the-tidyverse.html"><a href="the-tidyverse.html#how-do-i-index-rows-and-columns"><i class="fa fa-check"></i><b>5.4</b> How do I index rows and columns?</a></li>
<li class="chapter" data-level="5.5" data-path="the-tidyverse.html"><a href="the-tidyverse.html#how-do-i-calculate-basic-statistics"><i class="fa fa-check"></i><b>5.5</b> How do I calculate basic statistics?</a></li>
<li class="chapter" data-level="5.6" data-path="the-tidyverse.html"><a href="the-tidyverse.html#how-do-i-filter-data"><i class="fa fa-check"></i><b>5.6</b> How do I filter data?</a></li>
<li class="chapter" data-level="5.7" data-path="the-tidyverse.html"><a href="the-tidyverse.html#how-do-i-write-tidy-code"><i class="fa fa-check"></i><b>5.7</b> How do I write tidy code?</a></li>
<li class="chapter" data-level="5.8" data-path="the-tidyverse.html"><a href="the-tidyverse.html#key-points-3"><i class="fa fa-check"></i><b>5.8</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cleaning-up-data.html"><a href="cleaning-up-data.html"><i class="fa fa-check"></i><b>6</b> Cleaning Up Data</a><ul>
<li class="chapter" data-level="6.1" data-path="cleaning-up-data.html"><a href="cleaning-up-data.html#questions-4"><i class="fa fa-check"></i><b>6.1</b> Questions</a></li>
<li class="chapter" data-level="6.2" data-path="cleaning-up-data.html"><a href="cleaning-up-data.html#how-do-i-inspect-the-raw-data"><i class="fa fa-check"></i><b>6.2</b> How do I inspect the raw data?</a></li>
<li class="chapter" data-level="6.3" data-path="cleaning-up-data.html"><a href="cleaning-up-data.html#how-do-i-tidy-the-data"><i class="fa fa-check"></i><b>6.3</b> How do I tidy the data?</a></li>
<li class="chapter" data-level="6.4" data-path="cleaning-up-data.html"><a href="cleaning-up-data.html#key-points-4"><i class="fa fa-check"></i><b>6.4</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html"><i class="fa fa-check"></i><b>7</b> Non-Standard Evaluation</a><ul>
<li class="chapter" data-level="7.1" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#questions-5"><i class="fa fa-check"></i><b>7.1</b> Questions</a></li>
<li class="chapter" data-level="7.2" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#how-does-python-evaluate-function-calls"><i class="fa fa-check"></i><b>7.2</b> How does Python evaluate function calls?</a></li>
<li class="chapter" data-level="7.3" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#how-does-r-evaluate-the-same-kind-of-thing"><i class="fa fa-check"></i><b>7.3</b> How does R evaluate the same kind of thing?</a></li>
<li class="chapter" data-level="7.4" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#why-is-lazy-evaluation-useful"><i class="fa fa-check"></i><b>7.4</b> Why is lazy evaluation useful?</a></li>
<li class="chapter" data-level="7.5" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#what-is-tidy-evaluation"><i class="fa fa-check"></i><b>7.5</b> What is tidy evaluation?</a></li>
<li class="chapter" data-level="7.6" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#what-have-we-learned"><i class="fa fa-check"></i><b>7.6</b> What have we learned?</a></li>
<li class="chapter" data-level="7.7" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html#key-points-5"><i class="fa fa-check"></i><b>7.7</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="handling-errors.html"><a href="handling-errors.html"><i class="fa fa-check"></i><b>8</b> Handling Errors</a><ul>
<li class="chapter" data-level="8.1" data-path="handling-errors.html"><a href="handling-errors.html#questions-6"><i class="fa fa-check"></i><b>8.1</b> Questions</a></li>
<li class="chapter" data-level="8.2" data-path="handling-errors.html"><a href="handling-errors.html#key-points-6"><i class="fa fa-check"></i><b>8.2</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="object-oriented-programming.html"><a href="object-oriented-programming.html"><i class="fa fa-check"></i><b>9</b> Object-Oriented Programming</a><ul>
<li class="chapter" data-level="9.1" data-path="object-oriented-programming.html"><a href="object-oriented-programming.html#questions-7"><i class="fa fa-check"></i><b>9.1</b> Questions</a></li>
<li class="chapter" data-level="9.2" data-path="object-oriented-programming.html"><a href="object-oriented-programming.html#what-are-attributes"><i class="fa fa-check"></i><b>9.2</b> What are attributes?</a></li>
<li class="chapter" data-level="9.3" data-path="object-oriented-programming.html"><a href="object-oriented-programming.html#how-are-classes-represented"><i class="fa fa-check"></i><b>9.3</b> How are classes represented?</a></li>
<li class="chapter" data-level="9.4" data-path="object-oriented-programming.html"><a href="object-oriented-programming.html#how-does-inheritance-work"><i class="fa fa-check"></i><b>9.4</b> How does inheritance work?</a></li>
<li class="chapter" data-level="9.5" data-path="object-oriented-programming.html"><a href="object-oriented-programming.html#key-points-7"><i class="fa fa-check"></i><b>9.5</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="intellectual-debt.html"><a href="intellectual-debt.html"><i class="fa fa-check"></i><b>10</b> Intellectual Debt</a><ul>
<li class="chapter" data-level="10.1" data-path="intellectual-debt.html"><a href="intellectual-debt.html#questions-8"><i class="fa fa-check"></i><b>10.1</b> Questions</a></li>
<li class="chapter" data-level="10.2" data-path="intellectual-debt.html"><a href="intellectual-debt.html#why-shouldnt-i-use-setwd"><i class="fa fa-check"></i><b>10.2</b> Why shouldn’t I use <code>setwd</code>?</a></li>
<li class="chapter" data-level="10.3" data-path="intellectual-debt.html"><a href="intellectual-debt.html#how-do-i-write-formulas"><i class="fa fa-check"></i><b>10.3</b> How do I write formulas?</a></li>
<li class="chapter" data-level="10.4" data-path="intellectual-debt.html"><a href="intellectual-debt.html#what-the-hell-are-factors"><i class="fa fa-check"></i><b>10.4</b> What the hell are factors?</a></li>
<li class="chapter" data-level="10.5" data-path="intellectual-debt.html"><a href="intellectual-debt.html#how-do-i-refer-to-various-arguments-in-a-pipeline"><i class="fa fa-check"></i><b>10.5</b> How do I refer to various arguments in a pipeline?</a></li>
<li class="chapter" data-level="10.6" data-path="intellectual-debt.html"><a href="intellectual-debt.html#how-does-r-give-the-appearance-of-immutable-data"><i class="fa fa-check"></i><b>10.6</b> How does R give the appearance of immutable data?</a></li>
<li class="chapter" data-level="10.7" data-path="intellectual-debt.html"><a href="intellectual-debt.html#what-else-should-i-worry-about"><i class="fa fa-check"></i><b>10.7</b> What else should I worry about?</a></li>
<li class="chapter" data-level="10.8" data-path="intellectual-debt.html"><a href="intellectual-debt.html#key-points-8"><i class="fa fa-check"></i><b>10.8</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>11</b> Projects</a><ul>
<li class="chapter" data-level="11.1" data-path="projects.html"><a href="projects.html#questions-9"><i class="fa fa-check"></i><b>11.1</b> Questions</a></li>
<li class="chapter" data-level="11.2" data-path="projects.html"><a href="projects.html#whats-in-an-r-package"><i class="fa fa-check"></i><b>11.2</b> What’s in an R package?</a></li>
<li class="chapter" data-level="11.3" data-path="projects.html"><a href="projects.html#how-do-i-create-a-package"><i class="fa fa-check"></i><b>11.3</b> How do I create a package?</a></li>
<li class="chapter" data-level="11.4" data-path="projects.html"><a href="projects.html#key-points-9"><i class="fa fa-check"></i><b>11.4</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>12</b> Testing</a><ul>
<li class="chapter" data-level="12.1" data-path="testing.html"><a href="testing.html#questions-10"><i class="fa fa-check"></i><b>12.1</b> Questions</a></li>
<li class="chapter" data-level="12.2" data-path="testing.html"><a href="testing.html#what-should-i-know-about-testing-in-general"><i class="fa fa-check"></i><b>12.2</b> What should I know about testing in general?</a></li>
<li class="chapter" data-level="12.3" data-path="testing.html"><a href="testing.html#s:testing-warmup"><i class="fa fa-check"></i><b>12.3</b> How can I write a few simple tests?</a></li>
<li class="chapter" data-level="12.4" data-path="testing.html"><a href="testing.html#how-can-i-check-data-transformation"><i class="fa fa-check"></i><b>12.4</b> How can I check data transformation?</a><ul>
<li class="chapter" data-level="12.4.1" data-path="testing.html"><a href="testing.html#how-can-i-reorganize-code-to-make-it-more-testable"><i class="fa fa-check"></i><b>12.4.1</b> How can I reorganize code to make it more testable?</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="testing.html"><a href="testing.html#key-points-10"><i class="fa fa-check"></i><b>12.5</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="web-applications.html"><a href="web-applications.html"><i class="fa fa-check"></i><b>13</b> Web Applications</a><ul>
<li class="chapter" data-level="13.1" data-path="web-applications.html"><a href="web-applications.html#questions-11"><i class="fa fa-check"></i><b>13.1</b> Questions</a></li>
<li class="chapter" data-level="13.2" data-path="web-applications.html"><a href="web-applications.html#how-do-i-set-up-a-simple-application"><i class="fa fa-check"></i><b>13.2</b> How do I set up a simple application?</a></li>
<li class="chapter" data-level="13.3" data-path="web-applications.html"><a href="web-applications.html#how-do-i-create-a-user-interface"><i class="fa fa-check"></i><b>13.3</b> How do I create a user interface?</a></li>
<li class="chapter" data-level="13.4" data-path="web-applications.html"><a href="web-applications.html#how-do-i-create-a-server"><i class="fa fa-check"></i><b>13.4</b> How do I create a server?</a></li>
<li class="chapter" data-level="13.5" data-path="web-applications.html"><a href="web-applications.html#how-do-i-run-my-application"><i class="fa fa-check"></i><b>13.5</b> How do I run my application?</a></li>
<li class="chapter" data-level="13.6" data-path="web-applications.html"><a href="web-applications.html#how-can-i-improve-my-user-interface"><i class="fa fa-check"></i><b>13.6</b> How can I improve my user interface?</a></li>
<li class="chapter" data-level="13.7" data-path="web-applications.html"><a href="web-applications.html#how-can-i-display-the-data-in-a-file"><i class="fa fa-check"></i><b>13.7</b> How can I display the data in a file?</a></li>
<li class="chapter" data-level="13.8" data-path="web-applications.html"><a href="web-applications.html#how-can-i-break-circular-dependencies"><i class="fa fa-check"></i><b>13.8</b> How can I break circular dependencies?</a></li>
<li class="chapter" data-level="13.9" data-path="web-applications.html"><a href="web-applications.html#how-can-i-control-how-the-user-interface-is-rendered"><i class="fa fa-check"></i><b>13.9</b> How can I control how the user interface is rendered?</a></li>
<li class="chapter" data-level="13.10" data-path="web-applications.html"><a href="web-applications.html#key-points-11"><i class="fa fa-check"></i><b>13.10</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="using-python.html"><a href="using-python.html"><i class="fa fa-check"></i><b>14</b> Using Python</a><ul>
<li class="chapter" data-level="14.1" data-path="using-python.html"><a href="using-python.html#questions-12"><i class="fa fa-check"></i><b>14.1</b> Questions</a></li>
<li class="chapter" data-level="14.2" data-path="using-python.html"><a href="using-python.html#how-can-i-access-data-across-languages"><i class="fa fa-check"></i><b>14.2</b> How can I access data across languages?</a></li>
<li class="chapter" data-level="14.3" data-path="using-python.html"><a href="using-python.html#how-can-i-call-functions-across-languages"><i class="fa fa-check"></i><b>14.3</b> How can I call functions across languages?</a></li>
<li class="chapter" data-level="14.4" data-path="using-python.html"><a href="using-python.html#key-points-12"><i class="fa fa-check"></i><b>14.4</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>A</b> License</a></li>
<li class="chapter" data-level="B" data-path="code-of-conduct.html"><a href="code-of-conduct.html"><i class="fa fa-check"></i><b>B</b> Code of Conduct</a><ul>
<li class="chapter" data-level="B.1" data-path="code-of-conduct.html"><a href="code-of-conduct.html#our-standards"><i class="fa fa-check"></i><b>B.1</b> Our Standards</a></li>
<li class="chapter" data-level="B.2" data-path="code-of-conduct.html"><a href="code-of-conduct.html#our-responsibilities"><i class="fa fa-check"></i><b>B.2</b> Our Responsibilities</a></li>
<li class="chapter" data-level="B.3" data-path="code-of-conduct.html"><a href="code-of-conduct.html#scope"><i class="fa fa-check"></i><b>B.3</b> Scope</a></li>
<li class="chapter" data-level="B.4" data-path="code-of-conduct.html"><a href="code-of-conduct.html#enforcement"><i class="fa fa-check"></i><b>B.4</b> Enforcement</a></li>
<li class="chapter" data-level="B.5" data-path="code-of-conduct.html"><a href="code-of-conduct.html#attribution"><i class="fa fa-check"></i><b>B.5</b> Attribution</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>C</b> Citation</a></li>
<li class="chapter" data-level="D" data-path="contributing.html"><a href="contributing.html"><i class="fa fa-check"></i><b>D</b> Contributing</a></li>
<li class="chapter" data-level="E" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>E</b> Glossary</a></li>
<li class="chapter" data-level="F" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>F</b> Learning Objectives</a><ul>
<li class="chapter" data-level="F.1" data-path="learning-objectives.html"><a href="learning-objectives.html#values-and-vectors-1"><i class="fa fa-check"></i><b>F.1</b> Values and Vectors</a></li>
<li class="chapter" data-level="F.2" data-path="learning-objectives.html"><a href="learning-objectives.html#indexing-1"><i class="fa fa-check"></i><b>F.2</b> Indexing</a></li>
<li class="chapter" data-level="F.3" data-path="learning-objectives.html"><a href="learning-objectives.html#control-flow-1"><i class="fa fa-check"></i><b>F.3</b> Control Flow</a></li>
<li class="chapter" data-level="F.4" data-path="learning-objectives.html"><a href="learning-objectives.html#the-tidyverse-1"><i class="fa fa-check"></i><b>F.4</b> The Tidyverse</a></li>
<li class="chapter" data-level="F.5" data-path="learning-objectives.html"><a href="learning-objectives.html#cleaning-up-data-1"><i class="fa fa-check"></i><b>F.5</b> Cleaning Up Data</a></li>
<li class="chapter" data-level="F.6" data-path="learning-objectives.html"><a href="learning-objectives.html#non-standard-evaluation-1"><i class="fa fa-check"></i><b>F.6</b> Non-Standard Evaluation</a></li>
<li class="chapter" data-level="F.7" data-path="learning-objectives.html"><a href="learning-objectives.html#handling-errors-1"><i class="fa fa-check"></i><b>F.7</b> Handling Errors</a></li>
<li class="chapter" data-level="F.8" data-path="learning-objectives.html"><a href="learning-objectives.html#object-oriented-programming-1"><i class="fa fa-check"></i><b>F.8</b> Object-Oriented Programming</a></li>
<li class="chapter" data-level="F.9" data-path="learning-objectives.html"><a href="learning-objectives.html#intellectual-debt-1"><i class="fa fa-check"></i><b>F.9</b> Intellectual Debt</a></li>
<li class="chapter" data-level="F.10" data-path="learning-objectives.html"><a href="learning-objectives.html#projects-1"><i class="fa fa-check"></i><b>F.10</b> Projects</a></li>
<li class="chapter" data-level="F.11" data-path="learning-objectives.html"><a href="learning-objectives.html#testing-1"><i class="fa fa-check"></i><b>F.11</b> Testing</a></li>
<li class="chapter" data-level="F.12" data-path="learning-objectives.html"><a href="learning-objectives.html#web-applications-with-shiny"><i class="fa fa-check"></i><b>F.12</b> Web Applications with Shiny</a></li>
<li class="chapter" data-level="F.13" data-path="learning-objectives.html"><a href="learning-objectives.html#reticulate"><i class="fa fa-check"></i><b>F.13</b> Reticulate</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="key-points-13.html"><a href="key-points-13.html"><i class="fa fa-check"></i><b>G</b> Key Points</a><ul>
<li class="chapter" data-level="G.1" data-path="key-points-13.html"><a href="key-points-13.html#values-and-vectors-2"><i class="fa fa-check"></i><b>G.1</b> Values and Vectors</a></li>
<li class="chapter" data-level="G.2" data-path="key-points-13.html"><a href="key-points-13.html#indexing-2"><i class="fa fa-check"></i><b>G.2</b> Indexing</a></li>
<li class="chapter" data-level="G.3" data-path="key-points-13.html"><a href="key-points-13.html#control-flow-2"><i class="fa fa-check"></i><b>G.3</b> Control Flow</a></li>
<li class="chapter" data-level="G.4" data-path="key-points-13.html"><a href="key-points-13.html#the-tidyverse-2"><i class="fa fa-check"></i><b>G.4</b> The Tidyverse</a></li>
<li class="chapter" data-level="G.5" data-path="key-points-13.html"><a href="key-points-13.html#cleaning-up-data-2"><i class="fa fa-check"></i><b>G.5</b> Cleaning Up Data</a></li>
<li class="chapter" data-level="G.6" data-path="key-points-13.html"><a href="key-points-13.html#non-standard-evaluation-2"><i class="fa fa-check"></i><b>G.6</b> Non-Standard Evaluation</a></li>
<li class="chapter" data-level="G.7" data-path="key-points-13.html"><a href="key-points-13.html#handling-errors-2"><i class="fa fa-check"></i><b>G.7</b> Handling Errors</a></li>
<li class="chapter" data-level="G.8" data-path="key-points-13.html"><a href="key-points-13.html#object-oriented-programming-2"><i class="fa fa-check"></i><b>G.8</b> Object-Oriented Programming</a></li>
<li class="chapter" data-level="G.9" data-path="key-points-13.html"><a href="key-points-13.html#intellectual-debt-2"><i class="fa fa-check"></i><b>G.9</b> Intellectual Debt</a></li>
<li class="chapter" data-level="G.10" data-path="key-points-13.html"><a href="key-points-13.html#projects-2"><i class="fa fa-check"></i><b>G.10</b> Projects</a></li>
<li class="chapter" data-level="G.11" data-path="key-points-13.html"><a href="key-points-13.html#testing-2"><i class="fa fa-check"></i><b>G.11</b> Testing</a></li>
<li class="chapter" data-level="G.12" data-path="key-points-13.html"><a href="key-points-13.html#web-applications-with-shiny-1"><i class="fa fa-check"></i><b>G.12</b> Web Applications with Shiny</a></li>
<li class="chapter" data-level="G.13" data-path="key-points-13.html"><a href="key-points-13.html#reticulate-1"><i class="fa fa-check"></i><b>G.13</b> Reticulate</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Tidynomicon</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="projects" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Projects</h1>
<div id="questions-9" class="section level2">
<h2><span class="header-section-number">11.1</span> Questions</h2>
<ul>
<li>How do I create a package in R?</li>
<li>What can go in an R package?</li>
<li>How are R packages distributed?</li>
<li>What data formats can be used in an R package?</li>
<li>How should I document an R package?</li>
</ul>
<p>Mistakes were made in <a href="cleanup.html">the previous tutorial</a>.
It would be <a href="glossary.html#hubris">hubris</a> to believe that we will not make more as we continue to clean this data.
What will guide us safely through these dark caverns and back into the light of day?</p>
<p>The answer is testing.
We must test our assumptions, test our code, test our very <em>being</em> if we are to advance.
Luckily for us,
R provides tools for this purpose not unlike those available in Python.
In order to use them,
we must first venture into the greater realm of packaging in R.</p>
</div>
<div id="whats-in-an-r-package" class="section level2">
<h2><span class="header-section-number">11.2</span> What’s in an R package?</h2>
<p>Unlike Python,
with its confusing plethora of packaging tools,
R has one way to do it.
Before converting our project into a package,
we will explore what a package should contain.</p>
<ul>
<li>The text file <code>DESCRIPTION</code> (with no suffix) holds most of the package’s metadata,
including a description of what it,
who wrote it,
and what other packages it requires to run.
We will edit its contents as we go along.</li>
<li><code>NAMESPACE</code>,
whose name also has no extension, contains the names of everything exported from the package
(i.e., everything that is visible to the outside world).
As we will see,
we should leave its management in the hands of RStudio.</li>
<li>Just as <code>.gitignore</code> tells Git what files in a project to ignore,
<code>.Rbuildignore</code> tells RStudio which files it doesn’t need to worry about
when building a package from source.</li>
<li>All of the R source for our package must go in a directory called <code>R</code>;
sub-directories are not allowed.</li>
<li>As you would expect from its name,
the <code>data</code> directory contains all the data in our package.
In order for it to be loadable as part of the package,
the data must be saved in <code>.rda</code> format.
We can use R’s function <code>save</code> to do this
(and use <code>load</code> in our code to restore it),
but a better choice is to load the <code>usethis</code> library
and call <code>usethis::use_data(object, overwrite = TRUE)</code>.</li>
<li>Manual pages go in the <code>man</code> directory.
The bad news is that they have to be in a sort-of-LaTeX format
that is only a bit less obscure than the runes inscribed on the ancient dagger
your colleague brought back from her latest archeological dig.
The good news is,
we can embed comments in our source code and use a tool called roxygen2
to extract them and format them as required.</li>
<li>The <code>tests</code> directory holds the package’s unit tests.
It should contain files with names like <code>test_<em>some_feature</em>.R</code>,
which should in turn contain functions named <code>test_<em>something_specific</em></code>.
We’ll have a closer look at these later.</li>
</ul>
<p>In order to understand the rest of what follows,
it’s important to understand that R packages are distributed as compiled bytecode,
<em>not</em> as source code (which is how Python does it).
When a package is built,
R loads and checks the code,
then saves the corresponding instructions.
Our R files should therefore define functions,
not run commands immediately,
because if they do the latter,
those commands will be executed every time the script loads,
which is probably not what users will want.</p>
<p>As a side effect,
this means that if a package uses <code>load(something)</code>,
then that <code>load</code> command is executed <em>while the package is being compiled</em>,
and <em>not</em> while the compiled package is being loaded by a user after distribution.
Thus,
this simple and rather pointless “package”:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stringr)

sr &lt;-<span class="st"> </span><span class="cf">function</span>(text, pattern, replacement) {
  <span class="kw">str_replace</span>(text, pattern, replacement)
}</code></pre>
<p>probably won’t work when it’s loaded by a user,
because <code>stringr</code> may not be in memory on the user’s machine at the time <code>str_replace</code> is called.</p>
<p>How then can our packages use libraries?
The safest way is to use <a href="glossary.html#fully-qualified-name">fully-qualified names</a>
such as <code>stringr::str_replace</code>
every time we call a function defined somewhere outside our package.
We will explore other options below.</p>
<p>And while we’re hedging the statements we have already made:</p>
<ol style="list-style-type: decimal">
<li>Data that <em>isn’t</em> meant to be loaded directly into are should go in <code>inst/extdata</code>.
The first part of the directory name, <code>inst</code>, is short for “install”:
when the package is installed,
everything in this directory is bumped up a level and put in the installation directory.
Thus,
the installation directory will get a sub-directory called <code>extdata</code> (for “external data”),
and that can hold whatever we want.</li>
<li>We should always put <code>LazyData: TRUE</code> in <code>DESCRIPTION</code>
so that datasets are only loaded on demand.</li>
</ol>
</div>
<div id="how-do-i-create-a-package" class="section level2">
<h2><span class="header-section-number">11.3</span> How do I create a package?</h2>
<p>We cannot turn this tutorial into an R package because we’re building it as a website, not as a package.
Instead, we will create an R package called <code>unicefdata</code> to hold cleaned-up copies of
<a href="https://data.unicef.org/resources/dataset/hiv-aids-statistical-tables/">some HIV/AIDS data</a> and <a href="https://data.unicef.org/resources/dataset/maternal-health-data/">maternal health data</a> from UNICEF.</p>
<p>The first step is to run RStudio’s project creation wizard.
We will create <code>unicefdata</code> directly under our home directory,
make it a Git repository,
and turn on Packrat (a package manager for R):</p>
<div class="figure"><span id="fig:unnamed-chunk-301"></span>
<img src="figures/projects/rstudio-project-creation-wizard.png" alt="RStudio Project Creation Wizard" width="274" />
<p class="caption">
Figure 11.1: RStudio Project Creation Wizard
</p>
</div>
<p>Before doing our first commit to version control,
we remove <code>R/hello.R</code> and <code>man/hello.Rd</code>
(which the project wizard helpfully provides as starting points),
and add <code>README.md</code>, <code>LICENSE.md</code>, <code>CONDUCT.md</code>, and <code>CITATION.md</code>
to describe the project as a whole,
its license,
the contributor code of conduct,
and how we want the project cited.
These files are nothing to do with R per se
(and as we’ll see below, R isn’t entirely happy having them here with these names),
but every project should have all four of these <em>somewhere</em>.</p>
<p>After committing all of this to version control,
we copy the data tidying script we wrote previous into <code>R/tidy_datasets.R</code>.
For reference,
this is what the file looks like at this point:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

<span class="co"># Constants.</span>
raw_filename &lt;-<span class="st"> &quot;inst/extdata/infant_hiv.csv&quot;</span>
tidy_filename &lt;-<span class="st"> &quot;/tmp/infant_hiv.csv&quot;</span>
first_year &lt;-<span class="st"> </span><span class="dv">2009</span>
last_year &lt;-<span class="st"> </span><span class="dv">2017</span>
num_rows &lt;-<span class="st"> </span><span class="dv">192</span>

<span class="co"># Get and clean percentages.</span>
raw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(raw_filename, <span class="dt">skip =</span> <span class="dv">2</span>, <span class="dt">na =</span> <span class="kw">c</span>(<span class="st">&quot;-&quot;</span>))
raw<span class="op">$</span>ISO3[raw<span class="op">$</span>Countries <span class="op">==</span><span class="st"> &quot;Kosovo&quot;</span>] &lt;-<span class="st"> &quot;UNK&quot;</span>
sliced &lt;-<span class="st"> </span><span class="kw">slice</span>(raw, <span class="dv">1</span><span class="op">:</span>num_rows)
countries &lt;-<span class="st"> </span>sliced<span class="op">$</span>ISO3
percents &lt;-<span class="st"> </span>sliced <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ISO3, <span class="op">-</span>Countries) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">map_dfr</span>(str_replace, <span class="dt">pattern =</span> <span class="st">&quot;&gt;?(</span><span class="ch">\\</span><span class="st">d+)%&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">map_dfr</span>(<span class="cf">function</span>(col) <span class="kw">as.numeric</span>(col) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)

<span class="co"># Separate three-column chunks and add countries and years.</span>
num_years &lt;-<span class="st"> </span>(last_year <span class="op">-</span><span class="st"> </span>first_year) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
chunks &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, num_years)
<span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_years) {
  start =<span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>(year <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  chunks[[year]] &lt;-<span class="st"> </span><span class="kw">select</span>(percents, start<span class="op">:</span>(start <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">rename</span>(<span class="dt">estimate =</span> <span class="dv">1</span>, <span class="dt">hi =</span> <span class="dv">2</span>, <span class="dt">lo =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">country =</span> countries,
           <span class="dt">year =</span> <span class="kw">rep</span>((first_year <span class="op">+</span><span class="st"> </span>year) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, num_rows)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(country, year, <span class="kw">everything</span>())
}

<span class="co"># Combine chunks and order by country and year.</span>
tidy &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(chunks) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(country, year)

<span class="co"># Check.</span>
<span class="kw">write_csv</span>(tidy, tidy_filename)</code></pre>
<p>We’re going to need to wrap this up as a function
so that these commands aren’t executed while the library loads,
and we should probably also allow the user to specify the locations of the input and output files—we’ll come back
and do all of this later.</p>
<p>First,
though,
let’s edit <code>DESCRIPTION</code> and:</p>
<ol style="list-style-type: decimal">
<li>change the <code>Title</code>, <code>Author</code>, <code>Maintainer</code>, and <code>Description</code>;</li>
<li>change the <code>License</code> to <a href="https://choosealicense.com/licenses/mit/"><code>MIT</code></a> (see <a href="https://choosealicense.com/">Choose a License</a> for other options); and</li>
<li>go to the <code>Build</code> tab in RStudio and run ’Check` to see if our package meets CRAN’s standards.</li>
</ol>
<p>A note on this:
<a href="https://cran.r-project.org/">CRAN</a> is the Comprehensive R Archive Network.
Like the <a href="https://pypi.org/">Python Package Index</a>,
it is the place to go to find the packages you need.
CRAN’s rules are famously strict,
which ensures that packages run for everyone,
but which also makes package development a little more onerous than it might be.</p>
<p>For example,
when we run <code>Check</code>,
we get this:</p>
<pre class="text"><code>* checking top-level files ... NOTE
Non-standard files/directories found at top level:
  &#39;CITATION.md&#39; &#39;CONDUCT.md&#39; &#39;LICENSE.md&#39;
...
Found the following CITATION file in a non-standard place:
  CITATION.md
Most likely &#39;inst/CITATION&#39; should be used instead.</code></pre>
<p>After a bit of searching online,
we rearrange these files as follows:</p>
<ol style="list-style-type: decimal">
<li><code>LICENSE.md</code> becomes <code>LICENSE</code> with no extension (but still in the root directory).</li>
<li>The <code>DESCRIPTION</code> entry for the license is updated to <code>License: MIT + file LICENSE</code> (spelled exactly that way).</li>
<li>We add lines to <code>.Rbuildignore</code> to tell R to ignore <code>CITATION.md</code> and <code>CONDUCT.md</code>.
We could instead move <code>CITATION.md</code> to <code>inst/CITATION</code>
so that it will be copied into the root of the installation directory on users’ machines,
but a lot of people expect to find the citation description in the root directory of the original project.
We could also duplicate the file,
and once the package is mature enough to deploy,
that might be the best answer.</li>
</ol>
<p>These changes fix the warnings about non-standard files in non-standard places,
but we are far from done—we also have this to deal with:</p>
<pre class="text"><code>checking for missing documentation entries ... WARNING
Undocumented code objects:
  &#39;tidy_infant_hiv&#39;
All user-level objects in a package should have documentation entries.</code></pre>
<p>Fair enough—we want people to know what our package is for and how to use it,
so a little documentation seems like a fair request.
For this,
we turn to Hadley Wickham’s <em><a href="http://r-pkgs.had.co.nz/">R Packages</a></em>
and Karl Broman’s “<a href="https://kbroman.org/pkg_primer/">R package primer</a>”
for advice on writing roxygen2 documentation.
We then return to our source file and wrap our existing code with this:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; Tidy up the infant HIV data set.</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @param src_path path to source file</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @return a tibble of tidy data</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @export</span>

tidy_infant_hiv &lt;-<span class="st"> </span><span class="cf">function</span>(src_path) {
  <span class="co"># ...all the code from before...</span>
  <span class="co"># Return the final tidy dataset.</span>
  tidy
}</code></pre>
<p>roxygen2 processes comment lines that start with <code>#'</code> (hash followed by single quote).
Putting a comment block right before a function associates that documentation with that function;
here,
we are saying that:</p>
<ul>
<li>the function has a single parameter called <code>src_path</code>;</li>
<li>it returns a tibble of tidy data; and</li>
<li>we want it exported (i.e., we want it to be visible outside the package).</li>
</ul>
<p>Our function is now documented,
but when we run <code>Check</code>,
we still get a warning.
After a bit more searching and experimentation,
we discover that we need to load the <code>devtools</code> package
and run <code>devtools::document()</code> to regenerate documentation:
it isn’t done automatically.
When we do this,
we get good news and bad news:</p>
<pre class="text"><code>Updating unicefdata documentation
Loading unicefdata
First time using roxygen2. Upgrading automatically...
Updating roxygen version in /Users/gvwilson/unicefdata/DESCRIPTION
Warning: The existing &#39;NAMESPACE&#39; file was not generated by roxygen2, and will not be overwritten.
Writing tidy_infant_hiv.Rd</code></pre>
<p>Ah—the tutorials did warn us about this.
We need to delete <code>NAMESPACE</code> and re-run <code>devtools:document()</code>
in order to create this file:</p>
<pre class="text"><code># Generated by roxygen2: do not edit by hand

export(tidy_infant_hiv)</code></pre>
<p>The comment at the start tells roxygen2 it can overwrite the file,
and reminds us that we shouldn’t edit it by hand.
The <code>export(tidy_infant_hiv)</code> directive is what we really want:
as you might guess,
it tells the package builder which function to make visible.</p>
<p>After doing this,
we go into “Build…More…Configure build tools” and check “Generate documentation with Roxygen”.
Running the build again gives us:</p>
<pre class="text"><code>tidy_infant_hiv: no visible global function definition for &#39;read_csv&#39;
tidy_infant_hiv: no visible global function definition for &#39;slice&#39;
tidy_infant_hiv: no visible global function definition for &#39;%&gt;%&#39;
tidy_infant_hiv: no visible global function definition for &#39;select&#39;
...several more...
tidy_infant_hiv: no visible global function definition for &#39;bind_rows&#39;
tidy_infant_hiv: no visible global function definition for &#39;arrange&#39;
Undefined global functions or variables:
  %&gt;% Countries ISO3 arrange bind_rows country everything map_dfr
  mutate read_csv rename select slice str_replace year</code></pre>
<p>This is the package loading problem mentioned earlier:
since our compiled-and-distributable package will only contain the bytecodes for its own functions,
direct calls to functions from other libraries won’t work after the package is installed.
We will demonstrate two ways to fix this.
First,
we can add this to the roxygen2 comment block for our function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; @import dplyr</span>
<span class="co">#&#39; @importFrom magrittr %&gt;%</span></code></pre>
<p>which tells the package builder that we want all of the functions in these two packages available.
Second (and more properly) we can change various call to use their package prefix, e.g.:</p>
<pre class="text"><code>  percents &lt;- sliced %&gt;%
    select(ISO3, Countries) %&gt;%
    purrr::map_dfr(stringr::str_replace, pattern = &quot;&gt;?(\\d+)%&quot;, replacement = &quot;\\1&quot;) %&gt;%
    purrr::map_dfr(function(col) as.numeric(col) / 100)</code></pre>
<p>This changes the error to one that is slightly more confusing:</p>
<pre class="text"><code>* checking package dependencies ... ERROR
Namespace dependencies not required: &#39;dplyr&#39; &#39;magrittr&#39;

See section &#39;The DESCRIPTION file&#39; in the &#39;Writing R Extensions&#39;
manual.
* DONE
Status: 1 ERROR
checking package dependencies ... ERROR
Namespace dependencies not required: &#39;dplyr&#39; &#39;magrittr&#39;</code></pre>
<p>More searching,
more experimentation,
and finally we add this to the <code>DESCRIPTION</code> file:</p>
<pre class="text"><code>Imports:
    readr (&gt;= 1.1.0),
    dplyr (&gt;= 0.7.0),
    magrittr (&gt;= 1.5.0),
    purrr (&gt;= 0.2.0),
    rlang (&gt;= 0.3.0),
    stringr (&gt;= 1.3.0)</code></pre>
<p>The <code>Imports</code> field in <code>DESCRIPTION</code> actually has nothing to do with importing functions;
it just ensures that those packages are installed when this package is.
As for the version numbers in parentheses,
we got those by running <code>packageVersion("readr")</code> and similar commands inside RStudio
and then rounding off.</p>
<p>All right: are we done now?
No, we are not:</p>
<pre class="text"><code>checking R code for possible problems ... NOTE
tidy_infant_hiv: no visible binding for global variable &#39;ISO3&#39;
tidy_infant_hiv: no visible binding for global variable &#39;Countries&#39;
tidy_infant_hiv: no visible binding for global variable &#39;country&#39;
tidy_infant_hiv: no visible binding for global variable &#39;year&#39;</code></pre>
<p>This is annoying but understandable.
When the package builder is checking our code,
it has no idea what columns are going to be in our data frames,
so it has no way to know if <code>ISO3</code> or <code>Countries</code> will cause a problem.
However,
this is just a <code>NOTE</code>, not an <code>ERROR</code>,
so we can try running “Build…Install and Restart”
to build our package,
re-start our R session (so that memory is clean),
and load our newly-created package,
and then run <code>tidy_infant_hiv("inst/extdata/infant_hiv.csv")</code>.
This produces:</p>
<pre class="text"><code>Error in read_csv(src_path, skip = 2, na = c(&quot;-&quot;)) : 
  could not find function &quot;read_csv&quot;</code></pre>
<p>After calling upon the names of Those Who Shall Not Be Named
and making a fresh cup of tea,
we re-read our code and realize that we forgot to rename <code>read_csv</code> to <code>readr::read_csv</code>.
Fixing this doesn’t fix the problem with column names, though;
to do that,
we add this to the roxygen2 comment block:</p>
<pre class="text"><code>#&#39; @importFrom rlang .data</code></pre>
<p>and then modify the calls that use naked column names to be:</p>
<pre class="text"><code>    select(-.data$ISO3, -.data$Countries) %&gt;%
    ...
    select(.data$country, .data$year, everything())
    ...
    arrange(.data$country, .data$year)</code></pre>
<p>What is this <code>.data</code> that we have invoked?
Typing <code>?rlang::.data</code> gives us the answer:
it is a pronoun that allows us to be explicit when we refer to an object inside the data.
Adding this—i.e.,
being explicity that <code>country</code> is a column of <code>.data</code> rather than an undefined variable—finally
(finally)
gives us a clean build.</p>
<p>But we are not done,
because we are never <em>truly</em> done,
any more than we are ever truly safe.
We still need to add our cleaned-up data to our package
and document the package as a whole.
There are three steps to this.</p>
<p>First, we load and clean the data, storing the cleaned tibble in a variable called <code>infant_hiv</code>,
then load the <code>usethis</code> package and called <code>usethis::use_data(infant_hiv)</code>
to store the tibble in <code>data/infant_hiv.rda</code>.
(We could just call <code>save</code> with the appropriate parameters,
but <code>usethis</code> is a useful set of tools for creating and managing R projects,
and in retrospect,
we should have started using it earlier.)
Note: we <em>must</em> save the data as <code>.rda</code>, not as (for example) <code>.rds</code> or <code>.csv</code>;
only <code>.rda</code> will be automatically loaded as part of the project.</p>
<p>Second,
we create a file called <code>R/infant_hiv.R</code> to hold documentation about the dataset
and put this in it:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; Tidied infant HIV data.</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; This tidy data is derived from the `infant_hiv.csv` file, which in turn is</span>
<span class="co">#&#39; derived from an Excel spreadsheet provided by UNICEF - see the README.md file</span>
<span class="co">#&#39; in the raw data directory for details.</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @format A data frame</span>
<span class="co">#&#39; \describe{</span>
<span class="co">#&#39;   \item{country}{Country reporting (ISO3 code)}</span>
<span class="co">#&#39;   \item{year}{Year reported}</span>
<span class="co">#&#39;   \item{estimate}{Best estimate of rate (may be NA)}</span>
<span class="co">#&#39;   \item{hi}{High end of estimate range (may be NA)}</span>
<span class="co">#&#39;   \item{lo}{Low end of estimate range (may be NA)}</span>
<span class="co">#&#39; }</span>
<span class="st">&quot;infant_hiv&quot;</span></code></pre>
<p>Everything except the last line is a roxygen2 comment block
that describes the data in plain language,
then uses some tags and directives to document its format and fields.
(Note that we have also documented our data in <code>inst/extdata/README.md</code>,
but that focuses on the format and meaning of the raw data,
not the cleaned-up version.)</p>
<p>The last line is the string <code>"infant_hiv"</code>,
i.e.,
the name of the dataset.
We will create one placeholder R file like this for each of our datasets,
and each will have that dataset’s name as the thing being documented.</p>
<p>We use a similar trick to document the package as a whole:
we create a file <code>R/unicefdata.R</code>
(i.e., a file with exactly the same name as the package)
and put this in it:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; Clean up and share some data from UNICEF on infant HIV rates and maternal mortality.</span>
<span class="co">#&#39;</span>
<span class="co">#&#39; @author Greg Wilson, \email{greg.wilson@rstudio.com}</span>
<span class="co">#&#39; @docType package</span>
<span class="co">#&#39; @name unicefdata</span>
<span class="ot">NULL</span></code></pre>
<p>That’s right:
to document the entire package,
we document <code>NULL</code>,
which is one of the few times R uses call-by-value.
(That’s a fairly clumsy joke,
but honestly,
who among us is at our best at times like these?)</p>
</div>
<div id="key-points-9" class="section level2">
<h2><span class="header-section-number">11.4</span> Key Points</h2>
<ul>
<li>An R package can contain code, data, and documentation.</li>
<li>R code is distributed as compiled bytecode in packages, not as source.</li>
<li>R packages are almost always distributed through CRAN, the Comprehensive R Archive Network.</li>
<li>Most of a project’s metadata goes in a file called <code>DESCRIPTION</code>.</li>
<li>Metadata related to imports and exports goes in a file called <code>NAMESPACE</code>.</li>
<li>Add patterns to a file called <code>.Rbuildignore</code> to ignore files or directories when building a project.</li>
<li>All source code for a package must go in the <code>R</code> sub-directory.</li>
<li><code>library</code> calls in a package’s source code will <em>not</em> be executed as the package is loaded after distribution.</li>
<li>Data can be included in a package by putting it in the <code>data</code> sub-directory.</li>
<li>Data must be in <code>.rda</code> format in order to be loaded as part of a package.</li>
<li>Data in other formats can be put in the <code>inst/extdata</code> directory, and will be installed when the package is installed.</li>
<li>Add comments starting with <code>#'</code> to an R file to document functions.</li>
<li>Use roxygen2 to extract these comments to create manual pages in the <code>man</code> directory.</li>
<li>Use <code>@export</code> directives in roxygen2 comment blocks to make functions visible outside a package.</li>
<li>Add required libraries to the <code>Imports</code> section of the <code>DESCRIPTION</code> file to indicate that your package depends on them.</li>
<li>Use <code>package::function</code> to access externally-defined functions inside a package.</li>
<li>Alternatively, add <code>@import</code> directives to roxygen2 comment blocks to make external functions available inside the package.</li>
<li>Import <code>.data</code> from <code>rlang</code> and use <code>.data$column</code> to refer to columns instead of using bare column names.</li>
<li>Create a file called <code>R/<em>package</em>.R</code> and document <code>NULL</code> to document the package as a whole.</li>
<li>Create a file called <code>R/<em>dataset</em>.R</code> and document the string <code>‘<em>dataset</em>’</code> to document a dataset.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intellectual-debt.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gvwilson/tidynomicon/edit/master/projects.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["tidynomicon.pdf", "tidynomicon.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
